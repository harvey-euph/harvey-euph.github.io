---
title: "ç­†è¨˜: Network"
date: 2025-10-02 00:00:00 +0800
categories: [Careers, Notes]
tags: [Tech, Network]
---

# TCP + TLS å®Œæ•´å°åŒ…æµç¨‹

---

## ğŸ”¹ TLS 1.2 ï¼ˆFull Handshakeï¼Œéœ€è¦ 2 RTT for TLSï¼‰

**TCP å»ºç«‹**
- **A.** Client â†’ Server : `SYN`
- **B.** Server â†’ Client : `SYN+ACK`
- **C.** Client â†’ Server : `ACK`

**TLS æ¡æ‰‹**
- **D.** Client â†’ Server : `ClientHello`  
  - æ”¯æ´çš„ Cipher Suites  
  - æ”¯æ´çš„ TLS ç‰ˆæœ¬  
  - Client Random  
- **E.** Server â†’ Client : `ServerHello + Certificate + ServerKeyExchange + ServerHelloDone`  
  - é¸å®š Cipher Suite / TLS ç‰ˆæœ¬  
  - Server Random  
  - Server Certificate (å…¬é‘°)  
  - Server KeyExchange (ECDHE å…¬é‘°)  
- **F.** Client â†’ Server : `ClientKeyExchange + ChangeCipherSpec + Finished`  
  - PreMasterSecret æˆ– ECDHE å…¬é‘°  
  - ChangeCipherSpec + Finished â†’ client é€²å…¥åŠ å¯†ç‹€æ…‹  
- **G.** Server â†’ Client : `ChangeCipherSpec + Finished`  
  - server é€²å…¥åŠ å¯†ç‹€æ…‹

**æ‡‰ç”¨å±¤**
- **H.** Client â†’ Server : `Encrypted Application Data (HTTP GET â€¦)`
- **I.** Server â†’ Client : `Encrypted Application Data (HTTP Response â€¦)`

â¡ï¸ **ç¸½å…± 3 RTT (TCP 1 + TLS 2)**

---

## ğŸ”¹ TLS 1.3 ï¼ˆFull Handshakeï¼Œéœ€è¦ 1 RTT for TLSï¼‰

**TCP å»ºç«‹**
- **A.** Client â†’ Server : `SYN`
- **B.** Server â†’ Client : `SYN+ACK`
- **C.** Client â†’ Server : `ACK`

**TLS æ¡æ‰‹**
- **D.** Client â†’ Server : `ClientHello (+ KeyShare)`  
  - Client Random  
  - Cipher Suites  
  - æ”¯æ´ç‰ˆæœ¬ (TLS 1.3)  
  - KeyShare (ECDHE å…¬é‘°)  
- **E.** Server â†’ Client : `ServerHello + EncryptedExtensions + Certificate + CertificateVerify + Finished`  
  - Server Random  
  - Server KeyShare (ECDHE å…¬é‘°)  
  - Server Certificate  
  - CertificateVerify  
  - Finished (server å·²å®Œæˆæ¡æ‰‹)  
- **F.** Client â†’ Server : `Finished`  
  - Client ä¹Ÿå®Œæˆæ¡æ‰‹ï¼Œé€²å…¥åŠ å¯†ç‹€æ…‹  

**æ‡‰ç”¨å±¤**
- **G.** Client â†’ Server : `Encrypted Application Data (HTTP GET â€¦)`
- **H.** Server â†’ Client : `Encrypted Application Data (HTTP Response â€¦)`

â¡ï¸ **ç¸½å…± 2 RTT (TCP 1 + TLS 1)**

---

## ğŸ”¹ TLS 1.3 with 0-RTT (Session Resumption)

**TCP å»ºç«‹ + TLS**
- **A.** Client â†’ Server : `SYN + ClientHello (+ KeyShare) + 0-RTT Application Data (HTTP GET â€¦)`  
- **B.** Server â†’ Client : `SYN+ACK + ServerHello (+ å¯é¸ early response)`  
- **C.** Client â†’ Server : `ACK`  
- **D.** Server â†’ Client : `EncryptedExtensions + Certificate + Finished + Encrypted Application Data (HTTP Response â€¦)`  
- **E.** Client â†’ Server : `Finished`

â¡ï¸ **åªéœ€ 1 RTT å°±èƒ½æ‹¿åˆ°ç¬¬ä¸€å€‹ Response**  
ï¼ˆ0-RTT è³‡æ–™ç¼ºä¹å‰å‘å®‰å…¨æ€§ï¼Œå¯èƒ½è¢«é‡æ”¾æ”»æ“Šï¼‰

---

# ğŸ”¹ å·®ç•°æ¯”è¼ƒè¡¨

| å”è­°ç‰ˆæœ¬       | TLS æ¡æ‰‹æ‰€éœ€ RTT | å¯ä»¥çœç•¥ / ç–Šåˆçš„è¨Šæ¯ |
|----------------|------------------|------------------------|
| TLS 1.2        | 2 RTT            | ç„¡ï¼ˆæ¯æ®µç¨ç«‹ï¼‰        |
| TLS 1.3        | 1 RTT            | ServerHello + Certificate + Finished åˆä½µï¼›ClientKeyExchange & Finished åˆä½µ |
| TLS 1.3 0-RTT  | 0 RTT (æ‡‰ç”¨å±¤) + 1 RTTï¼ˆç¢ºèªå®Œæˆï¼‰ | ClientHello èˆ‡ Application Data ç–Šåˆï¼›ServerHello èˆ‡ Application Response ç–Šåˆ |
